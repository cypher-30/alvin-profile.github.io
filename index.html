<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alvin Murithi | The Cygnus Archives</title>
    <style>
        /* Google Fonts Import */
        @import url('https://fonts.googleapis.com/css2?family=Sora:wght@400;700&family=Uncut+Sans:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap');

        /* CSS Variables and Base Styles */
        :root {
            --bg-deep-space-blue: #0B0F1A;
            --text-cold-white: #E9EBF8;
            --heading-synth-purple: #9C6ADE;
            --accent-alien-green: #64F4AC;
            --panel-bg: rgba(27, 33, 54, 0.5);
            --panel-border: rgba(100, 244, 172, 0.2);
            --font-main: 'Sora', sans-serif;
            --font-heading: 'Uncut Sans', sans-serif;
        }
        
        body.artistic-font {
            --font-main: 'Playfair Display', serif;
            --font-heading: 'Playfair Display', serif;
        }

        * { box-sizing: border-box; }

        /* Lenis Smooth Scroll Styles */
        html.lenis { height: auto; }
        .lenis.lenis-smooth { scroll-behavior: auto; }
        .lenis.lenis-smooth [data-lenis-prevent] { overscroll-behavior: contain; }
        .lenis.lenis-stopped { overflow: hidden; }
        .lenis.lenis-scrolling iframe { pointer-events: none; }

        /* Body and Typography */
        body {
            font-family: var(--font-main);
            background-color: var(--bg-deep-space-blue);
            color: var(--text-cold-white);
            margin: 0;
            overflow-x: hidden; /* Prevent horizontal scroll on all devices */
            transition: font-family 0.4s ease, background-color 0.2s, color 0.2s;
        }

        /* Apply overflow:hidden only on larger screens for Lenis to work */
        @media (min-width: 1024px) {
            body {
                overflow: hidden;
            }
        }

        h1, h2, h3, h4, h5, h6 {
             font-family: var(--font-heading);
        }

        /* Fixed UI Elements */
        #initials {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 100;
            font-family: 'Uncut Sans', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-cold-white);
        }

        #three-canvas {
            position: fixed;
            top: 0;
            left: 0;
            outline: none;
            z-index: 1;
        }

        /* Main Content Container */
        #content-container {
            position: relative;
            z-index: 2;
            width: 100%;
            visibility: visible;
            transition: opacity 0.5s ease;
        }
        #content-container.viewer-active {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Entry Overlay */
        #entry-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: var(--bg-deep-space-blue);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: opacity 0.5s ease;
        }
        #entry-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .entry-text {
            color: var(--accent-alien-green);
            font-size: 1.2rem;
            border: 1px solid var(--accent-alien-green);
            padding: 15px 30px;
            border-radius: 8px;
        }

        /* Generic Section Styling */
        .scroll-section {
            width: 100%;
            min-height: 100vh;
            padding: 100px 5vw;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
        }

        .section-header {
            max-width: 800px;
            margin-bottom: 80px;
            text-align: center;
        }

        .section-header h2 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            color: var(--heading-synth-purple);
            margin: 0;
        }
        .section-header p {
             max-width: 600px;
             margin: 20px auto 0;
        }
        
        /* Hero Section */
        #hero { justify-content: center; }
        #hero h1 { font-size: clamp(3rem, 7vw, 6rem); margin: 0 0 10px 0; line-height: 1.1; color: var(--text-cold-white); font-weight: 700; }
        #hero .hero-accent-heading { color: var(--heading-synth-purple); }
        #hero .hero-subheading { font-size: clamp(1rem, 2vw, 1.2rem); color: var(--text-cold-white); max-width: 700px; margin: 20px auto 0; }
        .scroll-indicator { position: absolute; bottom: 40px; font-size: 0.8rem; color: var(--accent-alien-green); opacity: 0.7; }

        /* About Section (Timeline) */
        #about .about-content { display: flex; flex-direction: column; align-items: center; gap: 80px; max-width: 1000px; width: 100%; }
        .timeline { text-align: left; position: relative; width: 100%; max-width: 500px; }
        .timeline::before { content: ''; position: absolute; left: 8px; top: 10px; bottom: 10px; width: 2px; background: var(--panel-border); }
        .timeline-item { position: relative; padding-left: 40px; margin-bottom: 40px; }
        .timeline-item:last-child { margin-bottom: 0; }
        .timeline-item::before { content: ''; position: absolute; left: 0px; top: 5px; width: 18px; height: 18px; border-radius: 50%; background: var(--accent-alien-green); }
        .timeline-item h3 { font-size: 1.5rem; color: var(--text-cold-white); margin: 0 0 5px 0; }

        /* Skills and Projects Grids */
        #skills-grid, #project-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 40px; width: 100%; max-width: 1600px; }
        
        .skill-category { background: var(--panel-bg); border: 1px solid var(--panel-border); border-radius: 12px; padding: 30px; backdrop-filter: blur(10px); text-align: left; }
        .skill-category h3 { color: var(--accent-alien-green); font-size: 1.5rem; margin: 0 0 15px 0; }
        .skill-category ul { list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; gap: 10px; }
        .skill-category li { background: rgba(100, 244, 172, 0.1); padding: 5px 12px; border-radius: 15px; font-size: 0.9rem; }

        .project-card { background: var(--panel-bg); border: 1px solid var(--panel-border); border-radius: 12px; padding: 30px; text-align: left; backdrop-filter: blur(10px); cursor: pointer; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .project-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .project-card h3 { font-size: 1.8rem; color: var(--text-cold-white); margin: 0 0 10px 0; }
        .project-card .category { color: var(--accent-alien-green); font-weight: bold; margin-bottom: 15px; display: block; }

        /* Floating UI Controls */
        #ui-controls-container { position: fixed; bottom: 30px; right: 30px; z-index: 100; }
        .ui-button { background: var(--panel-bg); border: 1px solid var(--panel-border); color: var(--accent-alien-green); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; backdrop-filter: blur(5px); transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1); }
        .ui-button:hover { background-color: rgba(100, 244, 172, 0.2); }
        
        #main-toggle-button { position: relative; z-index: 101; }
        #main-toggle-button svg { transition: transform 0.4s ease; }
        #ui-controls-container.open #main-toggle-button svg { transform: rotate(135deg); }

        .control-button { position: absolute; bottom: 0; right: 0; opacity: 0; transform: translate(0, 0) scale(0.5); pointer-events: none; }
        #ui-controls-container.open .control-button { opacity: 1; pointer-events: all; }
        #ui-controls-container.open #audio-toggle { transform: translateY(-80px); }
        #ui-controls-container.open #font-toggle { transform: translateY(-160px); }
        #ui-controls-container.open #lab-button { transform: translateY(-240px); }
        #ui-controls-container.open #lang-toggle { transform: translateY(-320px); }
        
        /* 3D Project Viewer Overlay Styles */
        #project-viewer-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(11, 15, 26, 0.8); backdrop-filter: blur(20px); z-index: 200; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.4s ease; }
        #project-viewer-overlay.visible { opacity: 1; pointer-events: all; }
        #project-viewer-overlay .close-button { position: absolute; top: 30px; right: 30px; cursor: pointer; color: var(--accent-alien-green); font-size: 2rem; z-index: 260; }
        #project-viewer-ui { position: absolute; bottom: 5vh; left: 5vw; max-width: 450px; color: white; z-index: 250; text-align: left; opacity: 0; transform: translateY(20px); transition: opacity 0.5s 0.5s ease, transform 0.5s 0.5s ease; }
        #project-viewer-overlay.visible #project-viewer-ui { opacity: 1; transform: translateY(0); }
        #project-viewer-ui h2 { font-size: clamp(2rem, 4vw, 3rem); color: var(--text-cold-white); }
        #project-viewer-ui .category { color: var(--accent-alien-green); }
        #project-viewer-ui .tech-stack { font-family: 'Sora', monospace; font-size: 0.9rem; color: var(--accent-alien-green); margin-top: 20px; word-spacing: 1rem; }

        /* Sandbox Section Styles */
        #sandbox-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; max-width: 1400px; }
        #sandbox-editor { background: #011627; color: #d6deeb; border: 1px solid var(--panel-border); border-radius: 8px; font-family: 'Sora', monospace; font-size: 1rem; height: 400px; resize: none; }
        #sandbox-canvas { border: 1px solid var(--panel-border); border-radius: 8px; }
        
        /* Generic Modal Styles (for Lab) */
        .modal {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(11, 15, 26, 0.8);
            backdrop-filter: blur(20px);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }
        .modal.visible { opacity: 1; pointer-events: all; }
        .modal-content {
            background: var(--bg-deep-space-blue);
            border: 1px solid var(--panel-border);
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.4s ease;
            position: relative;
        }
        .modal.visible .modal-content { transform: scale(1); }
        .modal-body { padding: 40px 50px; }
        .modal .close-button {
            position: absolute;
            top: 20px; right: 20px;
            cursor: pointer;
            color: var(--accent-alien-green);
            font-size: 1.5rem;
        }
        .modal h2 { font-size: 3rem; margin-bottom: 20px; color: var(--text-cold-white); }
        .modal p { font-size: 1.1rem; }

        /* Form Styling */
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: bold; }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--panel-border);
            border-radius: 4px;
            font-family: var(--font-main);
            font-size: 1rem;
            box-sizing: border-box;
            background: rgba(11, 15, 26, 0.8);
            color: var(--text-cold-white);
        }
        .btn-submit {
            background: var(--accent-alien-green);
            color: var(--bg-deep-space-blue);
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
        }

        /* Footer Styling */
        footer {
            text-align: center;
            padding: 50px 5vw;
            border-top: 1px solid var(--panel-border);
            margin-top: 100px;
        }
        .social-links {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 25px;
        }
        .social-links a {
            color: var(--text-cold-white);
            transition: color 0.3s ease;
        }
        .social-links a:hover {
            color: var(--accent-alien-green);
        }
        .social-links svg {
            width: 24px;
            height: 24px;
        }

        /* Easter Egg Styling */
        #quote-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(11, 15, 26, 0.9);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease;
        }
        #quote-overlay.visible {
            opacity: 1;
            pointer-events: all;
            cursor: pointer;
        }
        #quote-text {
            font-family: 'Playfair Display', serif;
            font-style: italic;
            font-size: clamp(2rem, 5vw, 4rem);
            max-width: 80%;
            text-align: center;
            color: var(--text-cold-white);
            pointer-events: none; /* So the overlay behind it gets the click */
        }
        #quote-text::after {
            content: '(Click to return)';
            display: block;
            font-size: 1rem;
            font-family: 'Sora', sans-serif;
            font-style: normal;
            margin-top: 20px;
            color: var(--accent-alien-green);
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div id="initials">AM</div>
    <div id="entry-overlay"><div class="entry-text" data-lang-key="entryText">Click to Enter the Archives</div></div>
    <canvas id="three-canvas"></canvas>
    
    <div id="content-container">
        <section id="hero" class="scroll-section">
            <h1 class="hero-line" data-lang-key="heroTitle1">Code with Cadence.</h1>
            <h1 class="hero-line hero-accent-heading" data-lang-key="heroTitle2">Design with Soul.</h1>
            <p class="hero-line hero-subheading" data-lang-key="heroSubtitle">I'm Alvin Murithi, a computer scientist crafting systems where data-driven logic meets human-centered design.</p>
            <div class="scroll-indicator hero-line" data-lang-key="scrollIndicator">Scroll to explore the archives</div>
        </section>

        <section id="about" class="scroll-section">
             <div class="section-header">
                 <h2 class="section-title" data-lang-key="aboutTitle">The Art of Becoming</h2>
                 <p data-lang-key="aboutSubtitle">My journey in computer science isn't a straight line, but a series of thresholds...</p>
             </div>
            <div class="timeline">
                <div class="timeline-item"><h3 data-lang-key="timeline1Title">Year 1: The Spark</h3><p data-lang-key="timeline1Desc">Wrote my first "Hello, World." It wasn't about the output; it was the realization that I could speak a machine's language. A new universe opened.</p></div>
                <div class="timeline-item"><h3 data-lang-key="timeline2Title">Year 2: Architecting Failure</h3><p data-lang-key="timeline2Desc">A passion project collapsed under its own complexity. It taught me that ego is a poor architect and that listening to the silence between the code is crucial.</p></div>
                <div class="timeline-item"><h3 data-lang-key="timeline3Title">Year 3: Finding Rhythm</h3><p data-lang-key="timeline3Desc">Components, state, and APIs stopped being just rules. They became a composition. I learned to find the cadence that makes an interface feel alive and intuitive.</p></div>
                <div class="timeline-item"><h3 data-lang-key="timeline4Title">Year 4: The Intelligent Layer</h3><p data-lang-key="timeline4Desc">Moved beyond interfaces to infuse them with intelligence. Explored how data models and machine learning could create experiences that anticipate, adapt, and assist.</p></div>
            </div>
        </section>
        
        <section id="skills" class="scroll-section">
            <div class="section-header"><h2 class="section-title" data-lang-key="skillsTitle">Core Competencies</h2><p data-lang-key="skillsSubtitle">My toolkit is a blend of analytical and creative technologies...</p></div>
            <div id="skills-grid">
                <div class="skill-category"><h3 data-lang-key="skillsCat1">Machine Learning & AI</h3><ul><li>Python</li><li>TensorFlow</li><li>PyTorch</li><li>Scikit-learn</li><li>NLP</li><li>Computer Vision</li></ul></div>
                <div class="skill-category"><h3 data-lang-key="skillsCat2">Data Science & Analysis</h3><ul><li>SQL</li><li>Pandas</li><li>NumPy</li><li>Plotly</li><li>Tableau</li><li>ETL Pipelines</li></ul></div>
                <div class="skill-category"><h3 data-lang-key="skillsCat3">Full-Stack Development</h3><ul><li>JavaScript</li><li>React</li><li>Node.js</li><li>PHP</li><li>Laravel</li><li>REST APIs</li></ul></div>
                <div class="skill-category"><h3 data-lang-key="skillsCat4">Design & Prototyping</h3><ul><li>Figma</li><li>Adobe XD</li><li>UI/UX Principles</li><li>Prototyping</li><li>User Research</li></ul></div>
            </div>
        </section>

        <section id="projects" class="scroll-section">
            <div class="section-header"><h2 class="section-title" data-lang-key="projectsTitle">Project Showcase</h2></div>
            <div id="project-grid"></div>
        </section>
        
        <section id="sandbox" class="scroll-section">
             <div class="section-header"><h2 class="section-title" data-lang-key="sandboxTitle">The Sandbox</h2><p data-lang-key="sandboxSubtitle">A playground for creative code. Feel free to experiment.</p></div>
            <div id="sandbox-container">
                <textarea id="sandbox-editor"></textarea>
                <canvas id="sandbox-canvas"></canvas>
            </div>
            <button id="run-sandbox" class="ui-button" style="width: 120px; border-radius: 8px; margin-top: 20px;" data-lang-key="runCode">Run Code</button>
        </section>

         <section id="contact" class="scroll-section">
            <div class="section-header">
                <h2 class="section-title" data-lang-key="contactTitle">Contact</h2>
                <p data-lang-key="contactSubtitle">Have a project, an idea, or just want to connect? Let's talk.</p>
                <p style="margin-top: 2rem; color: var(--accent-alien-green); font-size: 1.5rem;">ialvinmurithi@gmail.com</p>
                 <a href="#" style="margin-top: 1rem; display: inline-block; border: 1px solid var(--accent-alien-green); padding: 10px 20px; border-radius: 5px; text-decoration: none; color: var(--accent-alien-green);" data-lang-key="resumeButton">Download Resume</a>
            </div>
        </section>

        <footer>
            <p data-lang-key="footerRights">© 2025 Alvin Murithi. All Rights Reserved.</p>
            <div class="social-links">
                <a href="#" target="_blank" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>
                <a href="#" target="_blank" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                <a href="#" target="_blank" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>
            </div>
        </footer>
    </div>

    <!-- Easter Egg Overlay -->
    <div id="quote-overlay">
        <p id="quote-text">To appreciate the sun, you gotta know what rain is.</p>
    </div>

    <div id="ui-controls-container">
        <div id="font-toggle" class="ui-button control-button" title="Toggle Font Style"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7V4h3M20 10v3M14 20h3v-3M4 14v3M10 4h3v16h-3M17 10h3v10h-3"/></svg></div>
        <div id="lab-button" class="ui-button control-button" title="Control Room"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg></div>
        <div id="audio-toggle" class="ui-button control-button" title="Toggle Audio"><svg id="icon-muted" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line></svg><svg id="icon-playing" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none;"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg></div>
        <div id="lang-toggle" class="ui-button control-button" title="Switch Language"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg></div>
        <div id="main-toggle-button" class="ui-button"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg></div>
    </div>
    
    <audio id="ambient-audio" loop>
        <source src="./promisedconsort.mp3" type="audio/mpeg">
    </audio>
    
    <div id="project-viewer-overlay"><div class="close-button">&times;</div><div id="project-viewer-ui"></div></div>

    <div id="lab-modal" class="modal"><div class="modal-content"><div class="close-button">&times;</div><div class="modal-body"><h2 data-lang-key="labTitle">Control Room</h2><p data-lang-key="labSubtitle">Add a new project to the archives. This is a demonstration of the UI; functionality is disabled in this local version.</p><form id="add-project-form" style="margin-top: 30px;"><div class="form-group"><label for="title" data-lang-key="formTitle">Project Title</label><input type="text" id="title" required></div><div class="form-group"><label for="category" data-lang-key="formCategory">Category</label><select id="category" required><option value="Machine Learning & AI">Machine Learning & AI</option><option value="Data Science & Analysis">Data Science & Analysis</option><option value="Full-Stack Web Development">Full-Stack Web Development</option><option value="Mobile Apps & Tooling">Mobile Apps & Tooling</option><option value="Graphic Design">Graphic Design</option><option value="Creative Coding">Creative Coding</option></select></div><div class="form-group"><label for="description" data-lang-key="formDescription">Short Description</label><textarea id="description" rows="2" required></textarea></div><div class="form-group"><label for="details" data-lang-key="formDetails">Detailed Information (Markdown supported)</label><textarea id="details" rows="5" required></textarea></div><div class="form-group"><label for="techStack" data-lang-key="formTech">Tech Stack (comma-separated)</label><input type="text" id="techStack" required></div><button type="submit" class="btn-submit" data-lang-key="formSubmit">Add to Archives</button><div id="form-feedback" style="margin-top: 15px;"></div></form></div></div></div>

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lenis@1.0.45/dist/lenis.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <script type="module">
        // --- DATA ---
        const langData = { 
            en: { entryText: "Click to Enter the Archives", heroTitle1: "Code with Cadence.", heroTitle2: "Design with Soul.", heroSubtitle: "I'm Alvin Murithi, a computer scientist crafting systems where data-driven logic meets human-centered design.", scrollIndicator: "Scroll to explore the archives", aboutTitle: "The Art of Becoming", aboutSubtitle: "My journey in computer science isn't a straight line, but a series of thresholds...", timeline1Title: "Year 1: The Spark", timeline1Desc: 'Wrote my first "Hello, World." It wasn\'t about the output; it was the realization that I could speak a machine\'s language. A new universe opened.', timeline2Title: "Year 2: Architecting Failure", timeline2Desc: "A passion project collapsed under its own complexity. It taught me that ego is a poor architect and that listening to the silence between the code is crucial.", timeline3Title: "Year 3: Finding Rhythm", timeline3Desc: "Components, state, and APIs stopped being just rules. They became a composition. I learned to find the cadence that makes an interface feel alive and intuitive.", timeline4Title: "Year 4: The Intelligent Layer", timeline4Desc: "Moved beyond interfaces to infuse them with intelligence. Explored how data models and machine learning could create experiences that anticipate, adapt, and assist.", skillsTitle: "Core Competencies", skillsSubtitle: "My toolkit is a blend of analytical and creative technologies...", skillsCat1: "Machine Learning & AI", skillsCat2: "Data Science & Analysis", skillsCat3: "Full-Stack Development", skillsCat4: "Design & Prototyping", projectsTitle: "Project Showcase", sandboxTitle: "The Sandbox", sandboxSubtitle: "A playground for creative code. Feel free to experiment.", runCode: "Run Code", contactTitle: "Contact", contactSubtitle: "Have a project, an idea, or just want to connect? Let's talk.", resumeButton: "Download Resume", labTitle: "Control Room", labSubtitle: "Add a new project to the archives. This is a demonstration of the UI; functionality is disabled in this local version.", formTitle: "Project Title", formCategory: "Category", formDescription: "Short Description", formDetails: "Detailed Information (Markdown supported)", formTech: "Tech Stack (comma-separated)", formSubmit: "Add to Archives", footerRights: "© 2025 Alvin Murithi. All Rights Reserved." }, 
            es: { entryText: "Clic para Entrar a los Archivos", heroTitle1: "Código con Cadencia.", heroTitle2: "Diseño con Alma.", heroSubtitle: "Soy Alvin Murithi, un científico de la computación que crea sistemas donde la lógica basada en datos se une con el diseño centrado en el ser humano.", scrollIndicator: "Desliza para explorar los archivos", aboutTitle: "El Arte de Convertirse", aboutSubtitle: "Mi viaje en la informática no es una línea recta, sino una serie de umbrales...", timeline1Title: "Año 1: La Chispa", timeline1Desc: 'Escribí mi primer "Hola, Mundo". No se trataba del resultado; fue la comprensión de que podía hablar el lenguaje de una máquina. Un nuevo universo se abrió.', timeline2Title: "Año 2: Arquitectando el Fracaso", timeline2Desc: "Un proyecto apasionante colapsó bajo su propia complejidad. Me enseñó que el ego es un mal arquitecto y que es crucial escuchar el silencio entre el código.", timeline3Title: "Año 3: Encontrando el Ritmo", timeline3Desc: "Los componentes, el estado y las API dejaron de ser solo reglas. Se convirtieron en una composición. Aprendí a encontrar la cadencia que hace que una interfaz se sienta viva e intuitiva.", timeline4Title: "Año 4: La Capa Inteligente", timeline4Desc: "Fui más allá de las interfaces para infundirles inteligencia. Explpré cómo los modelos de datos y el aprendizaje automático podían crear experiencias que anticipan, se adaptan y asisten.", skillsTitle: "Competencias Clave", skillsSubtitle: "Mi conjunto de herramientas es una mezcla de tecnologías analíticas y creativas...", skillsCat1: "Aprendizaje Automático e IA", skillsCat2: "Ciencia y Análisis de Datos", skillsCat3: "Desarrollo Full-Stack", skillsCat4: "Diseño y Prototipado", projectsTitle: "Galería de Proyectos", sandboxTitle: "El Laboratorio", sandboxSubtitle: "Un patio de recreo para el código creativo. Siéntete libre de experimentar.", runCode: "Ejecutar Código", contactTitle: "Contacto", contactSubtitle: "¿Tienes un proyecto, una idea o simplemente quieres conectar? Hablemos.", resumeButton: "Descargar CV", labTitle: "Sala de Control", labSubtitle: "Añade un nuevo proyecto a los archivos. Esto es una demostración de la interfaz; la funcionalidad está desactivada en esta versión local.", formTitle: "Título del Proyecto", formCategory: "Categoría", formDescription: "Descripción Corta", formDetails: "Información Detallada (Markdown soportado)", formTech: "Tecnologías (separadas por comas)", formSubmit: "Añadir a los Archivos", footerRights: "© 2025 Alvin Murithi. Todos los derechos reservados." } 
        };
        const localProjects = [ 
            { 
                id: 'proj1', 
                en: { title: 'Tumor Detection with CNNs', category: 'Machine Learning & AI', description: 'Developed a convolutional neural network to classify medical images for tumor detection.', details: 'This project involved training a custom CNN model on a dataset of brain scans. The primary goal was to achieve high accuracy in distinguishing between malignant and benign tumors. I used TensorFlow and Keras, implementing data augmentation techniques to improve model robustness. The final model achieved a 94% accuracy on the test set. A simple Streamlit app was built to demonstrate the model\'s predictions on new images.', techStack: 'Python, TensorFlow, Keras, Scikit-learn, Streamlit' },
                es: { title: 'Detección de Tumores con CNNs', category: 'Aprendizaje Automático e IA', description: 'Desarrollé una red neuronal convolucional para clasificar imágenes médicas para la detección de tumores.', details: 'Este proyecto implicó entrenar un modelo CNN personalizado en un conjunto de datos de escáneres cerebrales. El objetivo principal era lograr una alta precisión en la distinción entre tumores malignos y benignos. Usé TensorFlow y Keras, implementando técnicas de aumento de datos para mejorar la robustez del modelo. El modelo final alcanzó una precisión del 94% en el conjunto de prueba. Se creó una sencilla aplicación con Streamlit para demostrar las predicciones del modelo en nuevas imágenes.', techStack: 'Python, TensorFlow, Keras, Scikit-learn, Streamlit' }
            },
            { 
                id: 'proj2', 
                en: { title: 'SU Food Price Tracker', category: 'Data Science & Analysis', description: 'A web scraper and dashboard to track and analyze food price fluctuations across campus shops.', details: 'To address student budget concerns, I built a Python script using BeautifulSoup and Scrapy to collect daily price data from campus eatery websites. This data was stored in a PostgreSQL database. A dashboard, built with Plotly Dash, visualizes price trends over time, compares item prices across vendors, and identifies the best deals. This provides actionable insights for students.', techStack: 'Python, Scrapy, BeautifulSoup, PostgreSQL, Plotly Dash' },
                es: { title: 'Rastreador de Precios de Alimentos SU', category: 'Ciencia y Análisis de Datos', description: 'Un web scraper y panel para rastrear y analizar las fluctuaciones de precios de los alimentos en las tiendas del campus.', details: 'Para abordar las preocupaciones presupuestarias de los estudiantes, creé un script de Python con BeautifulSoup y Scrapy para recopilar datos diarios de precios de los sitios web de los comedores del campus. Estos datos se almacenaron en una base de datos PostgreSQL. Un panel, construido con Plotly Dash, visualiza las tendencias de precios a lo largo del tiempo, compara los precios de los artículos entre proveedores e identifica las mejores ofertas. Esto proporciona información útil para los estudiantes.', techStack: 'Python, Scrapy, BeautifulSoup, PostgreSQL, Plotly Dash' }
            },
            {
                id: 'proj3',
                en: { title: 'Civic Accountability Platform', category: 'Full-Stack Web Development', description: 'A platform for citizens to report local issues and track the status of official responses.', details: 'Built with PHP and MySQL on the backend and vanilla JavaScript on the frontend, this platform allows users to pin-point issues on a map, upload photos, and receive automated updates when the status of their report changes. It includes a simple admin dashboard for municipal workers to manage reports. The focus was on creating a simple, accessible tool for civic engagement.', techStack: 'PHP, MySQL, JavaScript, HTML, CSS, Leaflet.js' },
                es: { title: 'Plataforma de Responsabilidad Cívica', category: 'Desarrollo Web Full-Stack', description: 'Una plataforma para que los ciudadanos reporten problemas locales y sigan el estado de las respuestas oficiales.', details: 'Construida con PHP y MySQL en el backend y JavaScript puro en el frontend, esta plataforma permite a los usuarios señalar problemas en un mapa, subir fotos y recibir actualizaciones automáticas cuando cambia el estado de su informe. Incluye un panel de administración simple para que los trabajadores municipales gestionen los informes. El enfoque fue crear una herramienta simple y accesible para la participación cívica.', techStack: 'PHP, MySQL, JavaScript, HTML, CSS, Leaflet.js' }
            },
            {
                id: 'proj4',
                en: { title: 'QuickBill Split App', category: 'Mobile Apps & Tooling', description: 'A cross-platform mobile app to easily split bills and expenses among friends.', details: 'Using React Native, I developed an intuitive app that allows users to scan a receipt, itemize it, and assign items to different people. It calculates totals including tax and tip, and integrates with payment apps for easy settlement. The challenge was building a reliable OCR feature for receipt scanning and ensuring a smooth, native-like user experience on both iOS and Android.', techStack: 'React Native, OCR Library, Firebase' },
                es: { title: 'App para Dividir Cuentas QuickBill', category: 'Apps Móviles y Herramientas', description: 'Una aplicación móvil multiplataforma para dividir fácilmente facturas y gastos entre amigos.', details: 'Usando React Native, desarrollé una aplicación intuitiva que permite a los usuarios escanear un recibo, desglosarlo y asignar artículos a diferentes personas. Calcula los totales incluyendo impuestos y propinas, y se integra con aplicaciones de pago para una fácil liquidación. El desafío fue construir una función de OCR confiable para el escaneo de recibos y garantizar una experiencia de usuario fluida y similar a la nativa tanto en iOS como en Android.', techStack: 'React Native, Librería OCR, Firebase' }
            },
            {
                id: 'proj5',
                en: { title: 'Mental Health Poster Series', category: 'Graphic Design', description: 'A series of minimalist, typographic posters designed for emotional awareness campaigns.', details: 'Using a clean and modern aesthetic, I designed a series of posters focused on destigmatizing mental health topics. The designs rely on strong typography, a limited color palette, and impactful messaging to convey complex emotions in a simple, approachable way. Created using Adobe Illustrator and Figma.', techStack: 'Adobe Illustrator, Figma, Typography' },
                es: { title: 'Serie de Pósters sobre Salud Mental', category: 'Diseño Gráfico', description: 'Una serie de pósters minimalistas y tipográficos diseñados para campañas de concienciación emocional.', details: 'Utilizando una estética limpia y moderna, diseñé una serie de pósters centrados en desestigmatizar temas de salud mental. Los diseños se basan en una tipografía fuerte, una paleta de colores limitada y mensajes impactantes para transmitir emociones complejas de una manera simple y accesible. Creado con Adobe Illustrator y Figma.', techStack: 'Adobe Illustrator, Figma, Tipografía' }
            },
            {
                id: 'proj6',
                en: { title: 'Ambient Web Synth', category: 'Creative Coding', description: 'An interactive web experiment that lets users create ambient soundscapes by moving the mouse.', details: 'This project uses the Web Audio API and Three.js to create a generative music experience. The position of the mouse controls parameters like the pitch and filter cutoff of multiple synthesizer oscillators. The result is a calming, ever-changing sound pad that responds to user interaction, blending visual art with sound design.', techStack: 'Three.js, Web Audio API, JavaScript' },
                es: { title: 'Sintetizador Web Ambiental', category: 'Codificación Creativa', description: 'Un experimento web interactivo que permite a los usuarios crear paisajes sonoros ambientales moviendo el ratón.', details: 'Este proyecto utiliza la API de Web Audio y Three.js para crear una experiencia musical generativa. La posición del ratón controla parámetros como el tono y el corte del filtro de múltiples osciladores de sintetizador. El resultado es una almohadilla de sonido relajante y siempre cambiante que responde a la interacción del usuario, mezclando arte visual con diseño de sonido.', techStack: 'Three.js, Web Audio API, JavaScript' }
            }
        ];
        
        // --- STATE & INITIALIZATION ---
        let currentLang = 'en';
        let easterEggClickCount = 0;
        let soundsReady = false;
        let sandboxRunSynth, textFallSynth, discoLoop, quoteResetSynth;

        // --- UI & CONTENT FUNCTIONS ---
        function switchLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.dataset.langKey;
                if (langData[lang][key]) el.textContent = langData[lang][key];
            });
            renderProjects();
        }

        function renderProjects() {
            document.getElementById('project-grid').innerHTML = localProjects.map((project, index) => {
                const projectContent = project[currentLang];
                return `
                <div class="project-card" data-index="${index}">
                    <h3>${projectContent.title}</h3>
                    <span class="category">${projectContent.category}</span>
                    <p>${projectContent.description}</p>
                </div>`;
            }).join('');

            document.querySelectorAll('.project-card').forEach(card => {
                card.addEventListener('click', () => {
                    const projectIndex = card.dataset.index;
                    showProjectViewer(localProjects[projectIndex]);
                });
            });
        }
        
        renderProjects();
        
        // --- UI CONTROLS EVENT LISTENERS ---
        const uiContainer = document.getElementById('ui-controls-container');
        document.getElementById('main-toggle-button').addEventListener('click', () => uiContainer.classList.toggle('open'));

        const labModal = document.getElementById('lab-modal');
        document.getElementById('lab-button').addEventListener('click', () => labModal.classList.add('visible'));
        document.querySelector('#lab-modal .close-button').addEventListener('click', () => labModal.classList.remove('visible'));
        document.getElementById('add-project-form').addEventListener('submit', (e) => { e.preventDefault(); document.getElementById('form-feedback').textContent = 'Project adding is disabled.'; });

        const audio = document.getElementById('ambient-audio');
        const audioToggle = document.getElementById('audio-toggle');
        const iconMuted = document.getElementById('icon-muted');
        const iconPlaying = document.getElementById('icon-playing');
        
        document.getElementById('entry-overlay').addEventListener('click', async () => {
            document.getElementById('entry-overlay').classList.add('hidden');
            audio.play().catch(error => console.error("Audio playback failed:", error));
            
            if (!soundsReady && typeof Tone !== 'undefined') {
                await Tone.start();
                sandboxRunSynth = new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.01, decay: 0.5, sustain: 0.2, release: 0.5 }, volume: -10 }).toDestination();
                textFallSynth = new Tone.PolySynth(Tone.Synth, { oscillator: { type: 'sine' }, envelope: { attack: 0.01, decay: 0.5, sustain: 0, release: 0.8 }, volume: -15 }).toDestination();
                quoteResetSynth = new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.005, decay: 0.2, sustain: 0, release: 0.2 }, volume: -15 }).toDestination();
                
                const discoSynth = new Tone.Synth({ oscillator: { type: "fatsawtooth", count: 3, spread: 30 }, envelope: { attack: 0.01, decay: 0.2, sustain: 0.5, release: 0.4 }, volume: -12 }).toDestination();
                const discoPattern = ["C4", "E4", "G4", "B4"];
                discoLoop = new Tone.Sequence((time, note) => {
                    discoSynth.triggerAttackRelease(note, 0.1, time);
                }, discoPattern, "8n");
                soundsReady = true;
            }
        }, { once: true });

        audioToggle.addEventListener('click', () => audio.paused ? audio.play().catch(e=>console.error(e)) : audio.pause());
        audio.addEventListener('play', () => { iconPlaying.style.display = 'block'; iconMuted.style.display = 'none'; });
        audio.addEventListener('pause', () => { iconPlaying.style.display = 'none'; iconMuted.style.display = 'block'; });
        
        document.getElementById('font-toggle').addEventListener('click', () => document.body.classList.toggle('artistic-font'));
        document.getElementById('lang-toggle').addEventListener('click', () => switchLanguage(currentLang === 'en' ? 'es' : 'en'));

        // --- SCROLL & PAGE ANIMATIONS ---
        gsap.registerPlugin(ScrollTrigger);
        const lenis = new Lenis();
        
        gsap.from(".hero-line", { y: 50, opacity: 0, duration: 1, stagger: 0.2, ease: "power3.out" });
        document.querySelectorAll(".section-header, .timeline-item, .skill-category, .project-card, #sandbox-container, #run-sandbox, footer").forEach(el => {
            gsap.from(el, { scrollTrigger: { trigger: el, start: "top 95%" }, y: 50, opacity: 0, duration: 1 });
        });
        
        // --- THREE.JS SCENE MANAGEMENT ---
        const mainScene = new THREE.Scene();
        const projectScene = new THREE.Scene();
        let activeScene = mainScene;
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;
        const renderer = new THREE.WebGLRenderer({ canvas: document.querySelector('#three-canvas'), alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        
        const starfield = new THREE.Points(new THREE.BufferGeometry(), new THREE.PointsMaterial({ color: 0x9c6ade, size: 0.3, transparent: true, opacity: 0.5 }));
        const starPositions = new Float32Array(5000 * 3);
        for(let i=0; i < starPositions.length; i++) starPositions[i] = (Math.random() - 0.5) * 1000;
        starfield.geometry.setAttribute('position', new THREE.BufferAttribute(starPositions, 3));
        mainScene.add(starfield);
        
        // --- PROJECT VIEWER LOGIC ---
        const projectViewerOverlay = document.getElementById('project-viewer-overlay');
        const projectViewerUI = document.getElementById('project-viewer-ui');
        document.querySelector('#project-viewer-overlay .close-button').addEventListener('click', () => hideProjectViewer());

        let activeProjectObject = null;
        function showProjectViewer(projectData) {
            const projectContent = projectData[currentLang];

            if(activeProjectObject) projectScene.remove(activeProjectObject);
            projectScene.clear();
            projectScene.add(new THREE.AmbientLight(0xffffff, 0.5));
            const pointLight = new THREE.PointLight(0xffffff, 1);
            pointLight.position.set(5, 10, 15);
            projectScene.add(pointLight);

            const category = projectData.en.category; // Use English category for logic
            if (category.includes('AI') || category.includes('Machine Learning')) {
                activeProjectObject = new THREE.Group();
                const nodeGeo = new THREE.SphereGeometry(0.3, 16, 16);
                const nodeMat = new THREE.MeshStandardMaterial({ color: 0x9C6ADE, roughness: 0.4, metalness: 0.2 });
                for(let i=0; i<30; i++) {
                    const node = new THREE.Mesh(nodeGeo, nodeMat);
                    node.position.set((Math.random()-0.5)*15, (Math.random()-0.5)*10, (Math.random()-0.5)*15);
                    activeProjectObject.add(node);
                }
            } else if (category.includes('Data Science')) {
                 activeProjectObject = new THREE.Group();
                 const barGeo = new THREE.BoxGeometry(1,5,1);
                 const barMat = new THREE.MeshStandardMaterial({ color: 0x64F4AC, roughness: 0.6 });
                 for(let i=0; i<5; i++) {
                      const bar = new THREE.Mesh(barGeo, barMat);
                      bar.position.set((i-2)*2, 0, 0);
                      bar.scale.y = Math.random() * 2 + 0.5;
                      activeProjectObject.add(bar);
                 }
            } else if (category.includes('Full-Stack')) {
                activeProjectObject = new THREE.Group();
                const planeGeo = new THREE.BoxGeometry(7, 5, 0.15);
                for (let i = 0; i < 3; i++) {
                    const mat = new THREE.MeshStandardMaterial({ color: new THREE.Color().setHSL(0.55 + i * 0.1, 0.7, 0.6), roughness: 0.4, metalness: 0.2 });
                    const plane = new THREE.Mesh(planeGeo, mat);
                    plane.position.z = (i - 1) * 2.5;
                    activeProjectObject.add(plane);
                }
            } else if (category.includes('Mobile Apps')) {
                activeProjectObject = new THREE.Group();
                const phoneBodyGeo = new THREE.BoxGeometry(4, 8, 0.4);
                const phoneBodyMat = new THREE.MeshStandardMaterial({ color: 0x333333, roughness: 0.3, metalness: 0.7 });
                const phoneBody = new THREE.Mesh(phoneBodyGeo, phoneBodyMat);
                activeProjectObject.add(phoneBody);
                const screenGeo = new THREE.PlaneGeometry(3.6, 7.6);
                const screenMat = new THREE.MeshBasicMaterial({ color: 0x1a1a1a });
                const screen = new THREE.Mesh(screenGeo, screenMat);
                screen.position.z = 0.21;
                activeProjectObject.add(screen);
            } else if (category.includes('Graphic Design')) {
                activeProjectObject = new THREE.Group();
                const sphereGeo = new THREE.SphereGeometry(2.5, 32, 32);
                const sphereMat = new THREE.MeshStandardMaterial({ color: 0xDE3163, roughness: 0.1, metalness: 0.1 });
                const sphere = new THREE.Mesh(sphereGeo, sphereMat);
                sphere.position.x = -2.5;
                activeProjectObject.add(sphere);
                const boxGeo = new THREE.BoxGeometry(4, 4, 4);
                const boxMat = new THREE.MeshStandardMaterial({ color: 0x00BFFF, roughness: 0.7, metalness: 0.0 });
                const box = new THREE.Mesh(boxGeo, boxMat);
                box.position.x = 2.5;
                activeProjectObject.add(box);
            } else if (category.includes('Creative Coding')) {
                 activeProjectObject = new THREE.Mesh(new THREE.TorusKnotGeometry( 3, 1, 128, 16 ), new THREE.MeshNormalMaterial({ flatShading: true }));
            } else { 
                 activeProjectObject = new THREE.Mesh(new THREE.IcosahedronGeometry(4, 0), new THREE.MeshStandardMaterial({ color: 0xffffff, wireframe: true}));
            }

            projectScene.add(activeProjectObject);
            
            projectViewerUI.innerHTML = `<h2>${projectContent.title}</h2><p class="category">${projectContent.category}</p><p>${projectContent.details}</p><div class="tech-stack">${projectContent.techStack}</div>`;
            projectViewerOverlay.classList.add('visible');
            document.getElementById('content-container').classList.add('viewer-active');
            lenis.stop();
            
            activeScene = projectScene;
            gsap.to(camera.position, { z: 15, duration: 1.2, ease: 'power3.inOut'});
        }

        function hideProjectViewer() {
            projectViewerOverlay.classList.remove('visible');
            gsap.to(camera.position, { z: 5, duration: 1.2, ease: 'power3.inOut', onComplete: () => {
                activeScene = mainScene;
                document.getElementById('content-container').classList.remove('viewer-active');
                lenis.start();
            }});
        }
        
        // --- SANDBOX LOGIC ---
        const sandboxEditor = document.getElementById('sandbox-editor');
        const sandboxCanvas = document.getElementById('sandbox-canvas');
        const runSandboxBtn = document.getElementById('run-sandbox');
        const sandboxCtx = sandboxCanvas.getContext('2d');
        const defaultSandboxCode = `// Multilingual Greeting Animator Run the code
const greetings = [
    { lang: 'English', text: 'Hi, how are you?' },
    { lang: 'Kimeru', text: 'Muga, uri bwega' },
    { lang: 'Spanish', text: 'Hola, ¿cómo estás?' },
    { lang: 'Japanese', text: 'こんにちは、お元気ですか？' },
    { lang: 'Russian', text: 'Привет, как дела?' },
    { lang: 'German', text: 'Hallo, wie geht es dir?' },
    { lang: 'Hindi', text: 'नमस्ते, आप कैसे हैं?' },
    { lang: 'Swedish', text: 'Hej, hur mår du?' },
    { lang: 'Somali', text: 'Haye, sidee tahay?' },
    { lang: 'Italian', text: 'Ciao, come stai?' },
    { lang: 'Zulu', text: 'Sawubona, unjani?' },
    { lang: 'Arabic', text: 'مرحبا كيف حالك؟' }
    
];

let currentIndex = 0;

if (window.sandboxAnimation) {
    cancelAnimationFrame(window.sandboxAnimation);
}

ctx.font = 'bold 30px Sora';
ctx.textAlign = 'center';
ctx.textBaseline = 'middle';
const canvasCenter = { x: canvas.width / 2, y: canvas.height / 2 };

function animateGreeting(index) {
    if (index >= greetings.length) {
        animateGreeting(0);
        return;
    }
    
    const greeting = greetings[index];
    let alpha = 0;
    let stage = 'fadeIn';
    let startTime = null;

    function draw(timestamp) {
        if (!startTime) startTime = timestamp;
        const elapsedTime = timestamp - startTime;

        if (stage === 'fadeIn') {
            alpha = Math.min(1, elapsedTime / 1000);
            if (alpha >= 1) {
                stage = 'hold';
                startTime = timestamp; 
            }
        } else if (stage === 'hold') {
            alpha = 1;
            if (elapsedTime > 2000) {
                stage = 'fadeOut';
                startTime = timestamp;
            }
        } else if (stage === 'fadeOut') {
            alpha = Math.max(0, 1 - (elapsedTime / 1000));
            if (alpha <= 0) {
                animateGreeting(index + 1);
                return;
            }
        }
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.globalAlpha = alpha;
        ctx.fillStyle = '#64F4AC';
        ctx.fillText(greeting.text, canvasCenter.x, canvasCenter.y);
        ctx.globalAlpha = 1.0;

        window.sandboxAnimation = requestAnimationFrame(draw);
    }

    window.sandboxAnimation = requestAnimationFrame(draw);
}

animateGreeting(0);`;
        sandboxEditor.value = defaultSandboxCode;

        runSandboxBtn.addEventListener('click', () => {
            if(soundsReady) sandboxRunSynth.triggerAttackRelease("C4", "8n");
            try { new Function('ctx', 'canvas', sandboxEditor.value)(sandboxCtx, sandboxCanvas); } 
            catch(e) { console.error("Sandbox Error:", e); sandboxCtx.fillStyle = 'red'; sandboxCtx.fillText(e.message, 10, 30); }
        });

        // --- EASTER EGG LOGIC ---
        const satelliteGroup = new THREE.Group();
        const satelliteBody = new THREE.Mesh(
            new THREE.IcosahedronGeometry(1.5, 0),
            new THREE.MeshStandardMaterial({ color: 0x9C6ADE, flatShading: true })
        );
        satelliteGroup.add(satelliteBody);
        const satelliteRing = new THREE.Mesh(
            new THREE.TorusGeometry(2, 0.1, 8, 32),
            new THREE.MeshStandardMaterial({ color: 0x64F4AC, emissive: 0x64F4AC, emissiveIntensity: 0.5 })
        );
        satelliteRing.rotation.x = Math.PI / 2;
        satelliteGroup.add(satelliteRing);

        satelliteGroup.position.set(-200, 50, -150);
        mainScene.add(satelliteGroup);

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        function handleEasterEggClick() {
            easterEggClickCount++;

            if (easterEggClickCount === 1) {
                if (soundsReady) textFallSynth.triggerAttackRelease(['C4', 'A3', 'E3', 'C3'], '8n', Tone.now());
                const allText = document.querySelectorAll('h1, h2, h3, p, li, span, a, button, #initials');
                gsap.to(allText, {
                    y: '+=100',
                    opacity: 0,
                    duration: 1.5,
                    stagger: 0.02,
                    ease: 'power3.in',
                    onComplete: () => {
                        document.getElementById('quote-overlay').classList.add('visible');
                    }
                });
            } else if (easterEggClickCount >= 2) {
                startDiscoMode();
                easterEggClickCount = 0; 
            }
        }
        
        document.getElementById('quote-overlay').addEventListener('click', () => {
            if (soundsReady) quoteResetSynth.triggerAttackRelease('C6', '16n');
            const allText = document.querySelectorAll('h1, h2, h3, p, li, span, a, button, #initials');
            gsap.to(allText, {
                y: 0,
                opacity: 1,
                duration: 1,
                stagger: 0.01,
                ease: 'power3.out'
            });
            document.getElementById('quote-overlay').classList.remove('visible');
        });

        let discoInterval;
        function startDiscoMode() {
            if(soundsReady) {
                Tone.Transport.start();
                discoLoop.start(0);
            }
            const colors = ['#FF00FF', '#00FFFF', '#FFFF00', '#FF0000', '#00FF00', '#0000FF'];
            let colorIndex = 0;
            discoInterval = setInterval(() => {
                const accent = colors[colorIndex % colors.length];
                const heading = colors[(colorIndex + 2) % colors.length];
                document.documentElement.style.setProperty('--accent-alien-green', accent);
                document.documentElement.style.setProperty('--heading-synth-purple', heading);
                colorIndex++;
            }, 200);

            setTimeout(stopDiscoMode, 10000);
        }

        function stopDiscoMode() {
            if(soundsReady) {
                discoLoop.stop(0);
                Tone.Transport.stop();
            }
            clearInterval(discoInterval);
            document.documentElement.style.setProperty('--accent-alien-green', '#64F4AC');
            document.documentElement.style.setProperty('--heading-synth-purple', '#9C6ADE');
        }

        window.addEventListener('click', (event) => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(satelliteGroup.children, true);
            if (intersects.length > 0) {
                handleEasterEggClick();
            }
        });

        // --- GLOBAL EVENT LISTENERS & RENDER LOOP ---
        const cursor = { x: 0, y: 0 };
        window.addEventListener('mousemove', e => { cursor.x = e.clientX / window.innerWidth - 0.5; cursor.y = e.clientY / window.innerHeight - 0.5; });
        window.addEventListener('resize', () => { 
            camera.aspect = window.innerWidth / window.innerHeight; 
            camera.updateProjectionMatrix(); 
            renderer.setSize(window.innerWidth, window.innerHeight); 
        });

        function animate(time) {
            lenis.raf(time);
            
            if(activeScene === mainScene) {
                starfield.rotation.y = -lenis.scroll * 0.0001;
                
                satelliteGroup.position.x += 0.08; 
                satelliteGroup.rotation.y += 0.002;
                satelliteGroup.rotation.z += 0.001;

                if (satelliteGroup.position.x > 250) {
                    satelliteGroup.position.x = -250;
                    satelliteGroup.position.y = (Math.random() - 0.5) * 100;
                }
            }

            if(activeProjectObject && activeScene === projectScene) {
                activeProjectObject.rotation.y += 0.005;
                activeProjectObject.rotation.x += 0.001;
            }
            
            camera.position.x += (cursor.x * 2 - camera.position.x) * 0.05;
            camera.position.y += (-cursor.y * 2 - camera.position.y) * 0.05;
            camera.lookAt(0,0,0);
            
            renderer.render(activeScene, camera);
            requestAnimationFrame(animate);
        }
        animate();

    </script>
</body>
</html>
